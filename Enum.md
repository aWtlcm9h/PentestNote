# Enum

## Nmap  

全ポートのスキャン(時間はかかる)  
`sudo nmap -sS -Pn -p- IP`  

-sV -Aでバージョン情報とかを得るようになる(指定しているポートは確認したほうがよさそうなポート)
`nmap -sV -n -Pn -A -p 21-25,35,43,53,69,80-88,107-110,115,118,123,137-139,143,156,161-162,220,384,389,443-445,465,514,530,543-544,591,593,636,901-903,953,992,995,1025,1433-1434,1812,3000,3306,3389,3535,5000,5432,5555,7777,8008,8065,8080,8443,8888 IP`  

送信元を偽装するオプション(53番ポートを指定)  
`-g 53`  

## Directory search  

### dirsearch  

手軽なのでよく使っていた

[dirsearch](https://github.com/maurosoria/dirsearch)  

-uで指定したURLのディレクトリを列挙する  
`dirseach -u http://test.example.com/`  

Wordlistの %EXT% を-eで指定した文字列に置き換える  
※index.%EXT%
`-e html,txt,php,py`

もしWordlistが.%EXT%の形式で書かれていない場合は下記をつけるとうまくいくかもしれない  
-fは文字列の末尾に強制的にくっつける
`-f`  
-Oは拡張子を上書きする
`-O`  

### feroxbuster  

これは使いやすいうえに強い

[feroxbuster](https://github.com/epi052/feroxbuster)  

-xで拡張子を指定できる  
`./feroxbuster -u http://test.example.com/ -x php,txt,html,py`  

-wでWordlistを指定できる  
`-w /way/to/the/wordlist`  

-Hでヘッダをつけることができる
`-H "Authorization: Basic YWRtaW46YWRtaW4="`

### gobuster

ippsecが使ってる  

[gobuster](https://github.com/OJ/gobuster)  

-x で拡張子を指定、-oでファイル出力  
`gobuster dir -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -x php -o gobuster.txt -u http://test.example.com/`

## Subdomain search

### ffuf  

-HオプションでFUZZ.をくっつけたVHを指定すると、その部分をWordlistの文字列に置き換えてリクエストを送ってくれる。  

`ffuf -u http://test.example.com/ -H "Host: FUZZ.test.example.com" -w /opt/SecLists/Discovery/DNS/bitquark-subdomains-top1000000.txt`  

-fwオプションでレスポンスの文字数フィルタをかけることができる。  
※指定した文字数のレスポンスが返ってきた場合は表示しない  
`-fw 5`  

-fcオプションでステータスコードのフィルタをかけることができる。  
※指定したステータスコードで返ってきた場合は表示しない  
`-fc 301`  

-fsオプションでレスポンスのサイズでフィルタをかけることができる。  
※指定したサイズのレスポンスが返ってきた場合は表示しない  
`-fs 169`  

## LDAP  

### ldapsearch  

naming contextの列挙  
`ldapsearch -h test.example.com -x -s base namingcontexts`  

もっと深く探索  
`ldapsearch -h test.example.com -x -b "DC=test,DC=example,DC=com"`  

LDAP認証を使用(入っているのはHTB:Supportの認証情報)  
`ldapsearch -h test.example.com -D 'ldap@test.example.com' -w 'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz' -b "DC=test,DC=example,DC=com"| less`  

## SMB  

### crackmapexexc  

`crackmapexec smb test.example.com`  

共有フォルダの探索  
`crackmapexec smb test.example.com --shares`  

LDAP認証を使用(入っているのはHTB:Supportの認証情報)  
`crackmapexec smb test.example.com -u ldap -p 'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz'`  

### smbclient  

パスワードなしで共有フォルダの列挙  
`smbclient -N -L //test.example.com`  

パスワードなしで共有フォルダ(share)に接続  
`smbclient -N //test.example.com/share`  

## Bloodhound  

python版のbloodhound  
LDAP認証を使用(入っているのはHTB:Supportの認証情報)  
`bloodhound-python -c ALL -u ldap -p 'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz' -d test.example.com -ns 10.10.10.10`  
